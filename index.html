<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Symbols, Strings and Surprises</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content" ref="sections/intro/1">
<h1>Strings, Symbols and Surprises</h1>

<h2>@madrid-rb</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/intro/2">
<h1>Enrique Garc&#xED;a</h1>

<ul>
<li>github:   kikito</li>
<li>twitter: @otikik</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/intro/3">
<h1>Warning</h1>

<blockquote><p>Make it Work. Make it Right. Make it Fast.</p>

<p>-- <cite>Kent Beck</cite></p></blockquote></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="sections/symbols/1">
<h1>Symbols</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/symbols/2">
<h1>Immutability</h1>

<ul>
<li>Write only-once to memory</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content command" ref="sections/symbols/3">
<h1>String#to_sym</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/4">
<pre class="sh_ruby"><code>a = "hello".to_sym
b = ("hel" + "lo").to_sym</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="sections/symbols/5">
<h1>Object#object_id</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/6">
<pre class="sh_ruby"><code># Always the same object #

a = :hello
b = ("hel" + "lo").to_sym
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/7">
<pre class="sh_ruby"><code># Always the same object #

a = :hello
b = :hello
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/symbols/8">
<h1>Conclusions</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/symbols/9">
<h1>Pro: Convenient hash key</h1>

<ul>
<li>Basically just do <code>object_id</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/symbols/10">
<h1>Con: Immutability</h1>

<ul>
<li>Can't Modify</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/symbols/11">
<h1>Con: No GC</h1>

<ul>
<li>Never collected</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/symbols/12">
<h1>Alternative notation</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/13">
<pre class="sh_ruby"><code># Symbols with spaces #

a = "hello madrid-rb".to_sym</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/14">
<pre class="sh_ruby"><code># Alernative notation - spaces and hyphens #

a = "hello madrid-rb".to_sym
b = :"hello madrid-rb"
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/15">
<pre class="sh_ruby"><code># Alernative notation - newlines #

a = "hello\nmadrid-rb".to_sym
b = :"hello\nmadrid-rb"
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/symbols/16">
<pre class="sh_ruby"><code># Alernative notation - wtf! #

a = "hello
madrid-rb".to_sym
b = :"hello
madrid-rb"
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="sections/strings/1">
<h1>Strings</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/2">
<pre class="sh_ruby"><code># Same object by reference #
a = "hello"
b = a
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/3">
<pre class="sh_ruby"><code># Two literals are not the same object #
a = "hello"
b = "hello"
a.object_id == b.object_id # FALSE</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/4">
<h1>Mutability</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/strings/5">
<pre class="sh_ruby"><code># Plenty of ways of modifying a string
a = "hello"
a.upcase!
a == "HELLO" # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content command" ref="sections/strings/6">
<h1>Object#to_s</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/7">
<pre class="sh_ruby"><code># On strings, to_s returns self
a = "hello"
b = b.to_s
a.object_id == b.object_id # true</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/8">
<pre class="sh_ruby"><code># In general, it returns a new object
a = "hello"
b = :hello.to_s
a.object_id == b.object_id # FALSE</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/9">
<h1>Implicit calls to to_s</h1>

<ul>
<li>string interpolation: <code>"{a} {b}"</code></li>
<li>rendering - views, JSON ...</li>
<li>etc.</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/10">
<h1><code>Symbol#to_s</code></h1>

<ul>
<li>Creates a new string, every time it's called</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/11">
<pre class="sh_ruby"><code>a = :hello
puts a -- creates one string</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/12">
<pre class="sh_ruby"><code>a = :hello
1000.times{ puts a } # creates 1000 </code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/strings/13">
<h1>Conclusions</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/14">
<h1>Pro: Mutability</h1>

<ul>
<li>LOTS of methods</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/15">
<h1>Con: Complexity</h1>

<ul>
<li>LOTS of methods</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/16">
<h1>Pro: GC</h1>

<ul>
<li>Unlike symbols, they get GC'ed</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/17">
<h1>Con: Memory</h1>

<ul>
<li>Easy to generate too many objects</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/18">
<h1>String Concatenation</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/19">
<pre class="sh_ruby"><code># Lots of intermediate strings
a = "h" + "e" + "l" + "l" + "o"

# Equivalent to:
s1 = "h" + "e"
s2 =  s1 + "l"
s3 =  s2 + "l"
a  =  s3 + "o"</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/20">
<pre class="sh_ruby"><code># Less intermediate strings
a = "#{'h'} #{'e'} #{'l'} #{'l'} #{'o'}"

# Doesn't scale:
# * recursive methods
# * loops</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/21">
<pre class="sh_ruby"><code># StringIO works in all cases

require 'stringio'

b = StringIO.new
b &lt;&lt; "h" &lt;&lt; "e" &lt;&lt; "l" &lt;&lt; "l" &lt;&lt; "o"
a = b.string

# Uglier syntax</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/22">
<pre class="sh_ruby"><code># Array#join also works

b = [ "h", "e", "l", "l", "o" ]
a = b.join

# A bit more overhead than StringIO</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/strings/23">
<h1>That <code>%w</code> thing ...</h1></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/24">
<pre class="sh_ruby"><code># That %w thing ... #

b = %w[ h e l l o ]
a = b.join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/25">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w[ h e l l o ].join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/26">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w( h e l l o ).join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/27">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w{ h e l l o }.join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/28">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w+ h e l l o +.join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/29">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w~ h e l l o ~.join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/30">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w# h e l l o #.join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/31">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w. h e l l o ..join</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content execute" ref="sections/strings/32">
<pre class="sh_ruby"><code># That %w thing ... #

a = %w.foo bar baz

1..join.size</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="sections/strings/33">
<h1>Other operators</h1>

<ul>
<li>% %q %Q %W %r %s %x</li>
<li>... but no way of making an array of symbols</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="sections/thanks">
<h1>Thanks!</h1></div>
</div></div>

</body>
</html>
